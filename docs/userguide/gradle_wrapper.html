<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Gradle 包装器——Gradle 用户指南 2.14.1版 - The Gradle Wrapper - Gradle User Guide Version 2.14.1</title>
  <link xmlns:xslthl="http://xslthl.sf.net" type="text/css" rel="stylesheet" href="base.css">
  <link xmlns:xslthl="http://xslthl.sf.net" type="text/css" rel="stylesheet" href="docs.css">
  <link xmlns:xslthl="http://xslthl.sf.net" type="text/css" rel="stylesheet" href="userguide.css">
  <meta content="DocBook XSL Stylesheets V1.75.2" name="generator">
  <link rel="home" href="userguide.html" title="Gradle 用户指南 2.14.1版">
  <link rel="up" href="pt02.html" title="第二部分. 使用现有构建">
  <link rel="prev" href="tutorial_gradle_command_line.html" title="使用 Gradle 命令行——Gradle 用户指南 2.14.1版">
  <link rel="next" href="gradle_daemon.html" title="Gradle 守护进程——Gradle 用户指南 2.14.1版">
 </head>
 <body>
  <div class="navheader">
   <div>
    <div class="navbar"> 
     <a xmlns:xslthl="http://xslthl.sf.net" href="tutorial_gradle_command_line.html" title="使用 Gradle 命令行——Gradle 用户指南 2.14.1版">上一章</a>
     <span>|</span>
     <a xmlns:xslthl="http://xslthl.sf.net" href="userguide.html" title="Gradle 用户指南 2.14.1版">目录</a>
     <span>|</span>
     <a xmlns:xslthl="http://xslthl.sf.net" href="gradle_daemon.html" title="Gradle 守护进程——Gradle 用户指南 2.14.1版">下一章</a>
    </div>
   </div>
  </div>
  <div class="chapter">
   <div class="titlepage">
    <div>
     <div>
      <h1 xmlns:xslthl="http://xslthl.sf.net"><a name="gradle_wrapper"></a>第五章.&nbsp;Gradle 包装器</h1>
      <h3 xmlns:xslthl="http://xslthl.sf.net"><a name="gradle_wrapper"></a>Chapter&nbsp;5.&nbsp;The Gradle Wrapper</h3>
     </div>
    </div>
   </div>
   <div class="toc">
    <p><b>目录</b><br><b>Table of Contents</b></p>
    <dl>
     <dt>
      <span class="section"><a href="gradle_wrapper.html#using_wrapper_scripts">5.1. 使用 Wrapper 执行构建 - Executing a build with the Wrapper</a></span>
     </dt>
     <dt>
      <span class="section"><a href="gradle_wrapper.html#sec:wrapper_generation">5.2. 将 Wrapper 添加到项目中 - Adding the Wrapper to a project</a></span>
     </dt>
     <dt>
      <span class="section"><a href="gradle_wrapper.html#sec:configuration">5.3. 配置 - Configuration</a></span>
     </dt>
     <dt>
      <span class="section"><a href="gradle_wrapper.html#sec:verification">5.4. 下载的 Gradle 分发版的验证 - Verification of downloaded Gradle distributions</a></span>
     </dt>
     <dt>
      <span class="section"><a href="gradle_wrapper.html#sec:unix_file_permissions">5.5. Unix 文件权限 - Unix file permissions</a></span>
     </dt>
    </dl>
   </div>
   <p>大多数工具都需要在你的计算机上安装后才能使用。如果安装很容易，您可能会认为这没什么问题。但它对构建的用户来说可能是不必要的负担。同样重要的一个问题是，用户是否能为构建安装正确的版本？如果他们正在构建旧版本的软件的话要怎么办？<br>Most tools require installation on your computer before you can use them. If the installation is easy, you may think that’s fine. But it can be an unnecessary burden on the users of the build. Equally importantly, will the user install the right version of the tool for the build? What if they’re building an old version of the software?</p>
   <p>Gradle 包装器（以下称为“包装器”）解决了这两个问题，并且它是启动 Gradle 构建的首选方式。<br>The Gradle Wrapper (henceforth referred to as the “Wrapper”) solves both these problems and is the preferred way of starting a Gradle build.</p>
   <div class="section">
    <div class="titlepage">
     <div>
      <div>
       <h2 class="title"><a xmlns:xslthl="http://xslthl.sf.net" name="using_wrapper_scripts" class="section-anchor" href="#using_wrapper_scripts"></a>5.1. 使用包装器执行构建</h2>
       <h4 class="title"><a xmlns:xslthl="http://xslthl.sf.net" name="using_wrapper_scripts" class="section-anchor" href="#using_wrapper_scripts"></a>5.1.&nbsp;Executing a build with the Wrapper</h4>
      </div>
     </div>
    </div>
    <p>如果 Gradle 项目已经设置好 Wrapper（我们建议所有项目都这样做），你可以在项目的根目录下使用以下的命令之一来执行构建： <br>If a Gradle project has set up the Wrapper (and we recommend all projects do so), you can execute the build using one of the following commands from the root of the project:</p>
    <div class="itemizedlist">
     <ul class="itemizedlist">
      <li class="listitem"><p><strong class="userinput"><code>./gradlew &lt;task&gt;</code></strong> （在 Linux 和 Mac OS X 等类 Unix 平台上）</p><p><strong class="userinput"><code>./gradlew &lt;task&gt;</code></strong> (on Unix-like platforms such as Linux and Mac OS X)</p></li>
      <li class="listitem"><p><strong class="userinput"><code>gradlew &lt;task&gt;</code></strong> （在 Windows 上使用 gradlew.bat 批处理文件）</p><p><strong class="userinput"><code>gradlew &lt;task&gt;</code></strong> (on Windows using the gradlew.bat batch file)</p></li>
     </ul>
    </div>
    <p> 每个包装器都绑定到一个特定版本的 Gradle，因此当你首次为给定的 Gradle 版本运行上面的命令时，它将下载相应的 Gradle 发行版并使用它来执行构建。 <br>Each Wrapper is tied to a specific version of Gradle, so when you first run one of the commands above for a given Gradle version, it will download the corresponding Gradle distribution and use it to execute the build.</p>
    <div class="tip">
     <h3 class="title">IDE</h3>
     <p>通过 Gradle 项目的包装器导入 Gradle 项目时，你的 IDE 可能会要求使用 Gradle “all”发行版。这完全没问题，可以帮助 IDE 为构建文件提供代码完成。 <br>When importing a Gradle project via its wrapper, your IDE may ask to use the Gradle 'all' distribution. This is perfectly fine and helps the IDE provide code completion for the build files.</p>
     <h5 class="title">IDEs</h5>
    </div>
    <p>这不仅意味着你不必自己手动安装 Gradle，而且还可以确保使用构建所针对的 Gradle 版本。这使你的历史构建更加可靠。当你在用户指南、Stack Overflow、一些文章或其他任何地方看到以<strong class="userinput"><code>gradle ...</code></strong>开头的命令行时，只需要换成上面所述的对应系统的适当的命令语法。 <br>Not only does this mean that you don’t have to manually install Gradle yourself, but you are also sure to use the version of Gradle that the build is designed for. This makes your historical builds more reliable. Just use the appropriate syntax from above whenever you see a command line starting with <strong class="userinput"><code>gradle ...</code></strong> in the user guide, on Stack Overflow, in articles or wherever.</p>
    <p>为了完整起见，并确保你不会删除任何重要文件，以下展示了 Gradle 项目中构成 Wrapper 的文件和目录： <br>For completeness sake, and to ensure you don’t delete any important files, here are the files and directories in a Gradle project that make up the Wrapper:</p>
    <div class="itemizedlist">
     <ul class="itemizedlist">
      <li class="listitem"><p><code class="filename">gradlew</code>（Unix Shell 脚本）</p><p><code class="filename">gradlew</code> (Unix Shell script)</p></li>
      <li class="listitem"><p><code class="filename">gradlew.bat</code>（Windows 批处理文件）</p><p><code class="filename">gradlew.bat</code> (Windows batch file)</p></li>
      <li class="listitem"><p><code class="filename">gradle/wrapper/gradle-wrapper.jar</code>（包装器 JAR）</p><p><code class="filename">gradle/wrapper/gradle-wrapper.jar</code> (Wrapper JAR)</p></li>
      <li class="listitem"><p><code class="filename">gradle/wrapper/gradle-wrapper.properties</code>（包装器属性）</p><p><code class="filename">gradle/wrapper/gradle-wrapper.properties</code> (Wrapper properties)</p></li>
     </ul>
    </div>
    <p> </p>
    <p>如果你想知道 Gradle 发行包的存储位置，你可以在用户主目录 <code class="filename">$USER_HOME/.gradle/wrapper/dists</code> 下找到它们。 <br>If you’re wondering where the Gradle distributions are stored, you’ll find them in your user home directory under <code class="filename">$USER_HOME/.gradle/wrapper/dists</code>.</p>
   </div>
   <div class="section">
    <div class="titlepage">
     <div>
      <div>
       <h2 class="title"><a xmlns:xslthl="http://xslthl.sf.net" name="sec:wrapper_generation" class="section-anchor" href="#sec:wrapper_generation"></a>5.2. 将包装器添加到项目中</h2>
       <h4 class="title"><a xmlns:xslthl="http://xslthl.sf.net" name="sec:wrapper_generation" class="section-anchor" href="#sec:wrapper_generation"></a>5.2.&nbsp;Adding the Wrapper to a project</h4>
      </div>
     </div>
    </div>
    <p> 你 <span class="emphasis"><em>应该</em></span> 将包装器纳入版本控制。通过将包装器分发到项目中，任何人都可以在未安装 Gradle 的情况下使用它。更好的效果是能确保用户使用这个构建所设计的 Gradle 版本。当然，这对于 <a class="ulink" href="http://en.wikipedia.org/wiki/Continuous_integration" target="_top">连续集成</a> 服务器（即定期构建项目的服务器）也很重要，因为它不需要在服务器上进行配置。 <br>The Wrapper is something you <span class="emphasis"><em>should</em></span> check into version control. By distributing the Wrapper with your project, anyone can work with it without needing to install Gradle beforehand. Even better, users of the build are guaranteed to use the version of Gradle that the build was designed to work with. Of course, this is also great for <a class="ulink" href="http://en.wikipedia.org/wiki/Continuous_integration" target="_top">continuous integration</a> servers (i.e. servers that regularly build your project) as it requires no configuration on the server.</p>
    <p> 通过运行 <code class="literal">wrapper</code> 任务，包装器将被安装到项目中（此任务始终可用，即使它没有被添加到构建中）。要指定 Gradle 版本，请在命令上使用 <code class="literal">--gradle-version</code>。你还可以直接通过 <code class="literal">--gradle-distribution-url</code> 来设置下载 Gradle 的 URL。如果没有指定版本或分发 URL，包装器将被配置为执行 <code class="literal">wrapper</code> 任务的 gradle 的版本。所以如果使用 Gradle 2.4 执行 <code class="literal">wrapper</code> 任务，则包装器配置将默认为 2.4 版本。 <br>You install the Wrapper into your project by running the <code class="literal">wrapper</code> task. (This task is always available, even if you don't add it to your build). To specify a Gradle version use <code class="literal">--gradle-version</code> on the command-line. You can also set the URL to download Gradle from directly via <code class="literal">--gradle-distribution-url</code>. If no version or distribution URL is specified, the Wrapper will be configured to use the gradle version the <code class="literal">wrapper</code> task is executed with. So if you run the <code class="literal">wrapper</code> task with Gradle 2.4, then the Wrapper configuration will default to version 2.4.</p>
    <div class="example">
     <a xmlns:xslthl="http://xslthl.sf.net" name="wrapperCommandLine"></a>
     <p class="title"><b>示例 5.1. 运行包装器任务 - Example&nbsp;5.1.&nbsp;Running the Wrapper task</b></p>
     <div class="example-contents">
      <p><strong class="userinput"><code>gradle wrapper --gradle-version 2.0</code></strong> 的输出结果<br>Output of <strong class="userinput"><code>gradle wrapper --gradle-version 2.0</code></strong></p>
      <pre class="screen">&gt; gradle wrapper --gradle-version 2.0
:wrapper

BUILD SUCCESSFUL

Total time: 1 secs
</pre>
     </div>
    </div>
    <br class="example-break">
    <p> 可以通过在构建脚本中添加和配置一个 <a class="ulink" href="../dsl/org.gradle.api.tasks.wrapper.Wrapper.html" target="_top"><code class="classname">Wrapper</code></a> 任务，然后执行它来进一步自定义包装器。 <br>The Wrapper can be further customized by adding and configuring a <a class="ulink" href="../dsl/org.gradle.api.tasks.wrapper.Wrapper.html" target="_top"><code class="classname">Wrapper</code></a> task in your build script, and then executing it.</p>
    <div class="example">
     <a xmlns:xslthl="http://xslthl.sf.net" name="wrapperSimple"></a>
     <p class="title"><b>示例 5.2. 包装器任务 - Example&nbsp;5.2.&nbsp;Wrapper task</b></p>
     <div class="example-contents">
      <p><code class="filename">build.gradle</code></p>
      <pre class="programlisting">task wrapper(type: Wrapper) {
    gradleVersion = <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'2.0'</span>
}
</pre>
     </div>
    </div>
    <br class="example-break">
    <p> 执行这一操作之后，你会在你的项目目录中发现以下新生成或更新的文件（在使用的 Wrapper 任务为默认配置的情况下）。 <br>After such an execution you find the following new or updated files in your project directory (in case the default configuration of the Wrapper task is used).</p>
    <div class="example">
     <a xmlns:xslthl="http://xslthl.sf.net" name="wrapperSimple"></a>
     <p class="title"><b>示例 5.3. 包装器生成的文件 - Example&nbsp;5.3.&nbsp;Wrapper generated files</b></p>
     <div class="example-contents">
      <p>构建布局<br>Build layout</p>
      <pre class="programlisting">simple/
  gradlew
  gradlew.bat
  gradle/wrapper/
    gradle-wrapper.jar
    gradle-wrapper.properties
</pre>
     </div>
    </div>
    <br class="example-break">
    <p> 所有这些文件都 <span class="emphasis"><em>应该</em></span> 提交到版本控制系统中。这只需要执行一次。在将这些文件添加到项目之后，应该使用所添加的 <span class="command"><strong>gradlew</strong></span> 命令来构建项目。<span class="command"><strong>gradlew</strong></span> 命令的使用方式与 <span class="command"><strong>gradle</strong></span> 命令<span class="emphasis"><em>完全</em></span>一样。 <br>All of these files <span class="emphasis"><em>should</em></span> be submitted to your version control system. This only needs to be done once. After these files have been added to the project, the project should then be built with the added <span class="command"><strong>gradlew</strong></span> command. The <span class="command"><strong>gradlew</strong></span> command can be used <span class="emphasis"><em>exactly</em></span> the same way as the <span class="command"><strong>gradle</strong></span> command.</p>
    <p>如果要切换到新版本的 Gradle，不用重新运行包装器任务，只要修改 <code class="literal">gradle-wrapper.properties</code> 文件中的相应属性就可以了。但是如果你想利用 Gradle 包装器的新功能的话，你还是需要重新生成包装器文件。 <br>If you want to switch to a new version of Gradle you don't need to rerun the <code class="literal">wrapper</code> task. It is good enough to change the respective entry in the <code class="literal">gradle-wrapper.properties</code> file, but if you want to take advantage of new functionality in the Gradle wrapper, then you would need to regenerate the wrapper files.</p>
   </div>
   <div class="section">
    <div class="titlepage">
     <div>
      <div>
       <h2 class="title"><a xmlns:xslthl="http://xslthl.sf.net" name="sec:configuration" class="section-anchor" href="#sec:configuration"></a>5.3. 配置</h2>
       <h4 class="title"><a xmlns:xslthl="http://xslthl.sf.net" name="sec:configuration" class="section-anchor" href="#sec:configuration"></a>5.3.&nbsp;Configuration</h4>
      </div>
     </div>
    </div>
    <p>如果你使用 <span class="command"><strong>gradlew</strong></span> 运行 Gradle ，那么包装器会检查要使用的 Gradle 分发包是否可用。如果可用，它会将最初传给 <span class="command"><strong>gradlew</strong></span> 命令的所有参数都委托给这个分发包的 <span class="command"><strong>gradle</strong></span> 命令。如果它没有找到 Gradle 分发包，它会先下载它。 <br>If you run Gradle with <span class="command"><strong>gradlew</strong></span>, the Wrapper checks if a Gradle distribution for the Wrapper is available. If so, it delegates to the <span class="command"><strong>gradle</strong></span> command of this distribution with all the arguments passed originally to the <span class="command"><strong>gradlew</strong></span> command. If it didn't find a Gradle distribution, it will download it first.</p>
    <p> 配置 <code class="literal">Wrapper</code> 任务时，你可以指定要使用的 Gradle 版本。<span class="command"><strong>gradlew</strong></span> 命令将从 Gradle 仓库下载相应的分发包。另外，你也可以指定 Gradle 分发包的下载 URL，<span class="command"><strong>gradlew</strong></span> 命令会使用这个 URL 下载分发包。如果你没有指定 Gradle 版本或下载 URL，那么 <span class="command"><strong>gradlew</strong></span> 命令将下载生成了包装器文件的 Gradle 的版本。 <br>When you configure the <code class="literal">Wrapper</code> task, you can specify the Gradle version you wish to use. The <span class="command"><strong>gradlew</strong></span> command will download the appropriate distribution from the Gradle repository. Alternatively, you can specify the download URL of the Gradle distribution. The <span class="command"><strong>gradlew</strong></span> command will use this URL to download the distribution. If you specified neither a Gradle version nor download URL, the <span class="command"><strong>gradlew</strong></span> command will download whichever version of Gradle was used to generate the Wrapper files.</p>
    <p>有关如何配置包装器的详细信息，请参阅 API 文档中的 <a class="ulink" href="../dsl/org.gradle.api.tasks.wrapper.Wrapper.html" target="_top"><code class="classname">Wrapper</code></a> 类。 <br>For the details on how to configure the Wrapper, see the <a class="ulink" href="../dsl/org.gradle.api.tasks.wrapper.Wrapper.html" target="_top"><code class="classname">Wrapper</code></a> class in the API documentation.</p>
    <p>如果你不想项目在通过 <span class="command"><strong>gradlew</strong></span> 构建时进行下载，那么只需将 Gradle 分发包的 zip 文件添加到版本控制中包装器配置所指定的位置上。它支持相对 URL——你可以指定一个相对于 <code class="literal">gradle-wrapper.properties</code> 文件的位置的分发文件。 <br>If you don't want any download to happen when your project is built via <span class="command"><strong>gradlew</strong></span>, simply add the Gradle distribution zip to your version control at the location specified by your Wrapper configuration. A relative URL is supported - you can specify a distribution file relative to the location of <code class="literal">gradle-wrapper.properties</code> file.</p>
    <p>如果你通过包装器构建，这台机器上已安装的任何 Gradle 分发包都会被忽略。 <br>If you build via the Wrapper, any existing Gradle distribution installed on the machine is ignored.</p>
   </div>
   <div class="section">
    <div class="titlepage">
     <div>
      <div>
       <h2 class="title"><a xmlns:xslthl="http://xslthl.sf.net" name="sec:verification" class="section-anchor" href="#sec:verification"></a>5.4. 验证下载的 Gradle 发行版</h2>
       <h4 class="title"><a xmlns:xslthl="http://xslthl.sf.net" name="sec:verification" class="section-anchor" href="#sec:verification"></a>5.4.&nbsp;Verification of downloaded Gradle distributions</h4>
      </div>
     </div>
    </div>
    <p>Gradle 包装器允许通过 SHA-256 哈希值比较来验证下载的 Gradle 发行版。这通过防止中间人攻击者篡改下载的 Gradle 发行版，提高了对针对性攻击的安全性。 <br>The Gradle Wrapper allows for verification of the downloaded Gradle distribution via SHA-256 hash sum comparison. This increases security against targeted attacks by preventing a man-in-the-middle attacker from tampering with the downloaded Gradle distribution.</p>
    <p> 要启用此功能，你需要首先计算已知 Gradle 分发包的 SHA-256 哈希值。可以使用 Linux 和 OSX 或 Windows（通过<a class="ulink" href="https://www.cygwin.com/" target="_top">Cygwin</a>）的 <span class="command"><strong>shasum</strong></span> 命令生成 SHA-256 哈希值。 <br>To enable this feature you'll want to first calculate the SHA-256 hash of a known Gradle distribution. You can generate a SHA-256 hash from Linux and OSX or Windows (via <a class="ulink" href="https://www.cygwin.com/" target="_top">Cygwin</a>) with the <span class="command"><strong>shasum</strong></span> command.</p>
    <div class="example">
     <a xmlns:xslthl="http://xslthl.sf.net" name="N10442"></a>
     <p class="title"><b>示例 5.4. 生成 SHA-256 哈希值 - Example&nbsp;5.4.&nbsp;Generating a SHA-256 hash</b></p>
     <div class="example-contents">
      <pre class="programlisting">
&gt; shasum -a 256 gradle-2.4-all.zip
371cb9fbebbe9880d147f59bab36d61eee122854ef8c9ee1ecf12b82368bcf10  gradle-2.4-all.zip
</pre>
     </div>
    </div>
    <br class="example-break">
    <p> 将返回的哈希值使用 <code class="literal">distributionSha256Sum</code>属性添加到 <code class="literal">gradle-wrapper.properties</code>。 <br>Add the returned hash sum to the <code class="literal">gradle-wrapper.properties</code> using the <code class="literal">distributionSha256Sum</code> property.</p>
    <div class="example">
     <a xmlns:xslthl="http://xslthl.sf.net" name="N1044F"></a>
     <p class="title"><b>示例 5.5. 配置 SHA-256 校验验证 - Example&nbsp;5.5.&nbsp;Configuring SHA-256 checksum verification</b></p>
     <div class="example-contents">
      <p><code class="filename">gradle-wrapper.properties</code></p>
      <pre class="programlisting">
distributionSha256Sum=371cb9fbebbe9880d147f59bab36d61eee122854ef8c9ee1ecf12b82368bcf10
</pre>
     </div>
    </div>
    <br class="example-break">
   </div>
   <div class="section">
    <div class="titlepage">
     <div>
      <div>
       <h2 class="title"><a xmlns:xslthl="http://xslthl.sf.net" name="sec:unix_file_permissions" class="section-anchor" href="#sec:unix_file_permissions"></a>5.5. Unix 文件权限</h2>
       <h4 class="title"><a xmlns:xslthl="http://xslthl.sf.net" name="sec:unix_file_permissions" class="section-anchor" href="#sec:unix_file_permissions"></a>5.5.&nbsp;Unix file permissions</h4>
      </div>
     </div>
    </div>
    <p>包装器任务添加了相应的文件权限，以允许 <code class="literal">gradlew</code> *NIX 命令的执行。Subversion 会保留此文件权限。我们不确定其他版本控制系统是如何处理这一问题的，所以能让它始终可以使用的方法是执行 “<code class="literal">sh gradlew</code>”。 <br>The Wrapper task adds appropriate file permissions to allow the execution of the <code class="literal">gradlew</code> *NIX command. Subversion preserves this file permission. We are not sure how other version control systems deal with this. What should always work is to execute “<code class="literal">sh gradlew</code>”.</p>
   </div>
  </div>
  <div class="navfooter">
   <div>
    <div class="navbar"> 
     <a xmlns:xslthl="http://xslthl.sf.net" href="tutorial_gradle_command_line.html" title="使用 Gradle 命令行——Gradle 用户指南 2.14.1版">上一章</a>
     <span>|</span>
     <a xmlns:xslthl="http://xslthl.sf.net" href="userguide.html" title="Gradle 用户指南 2.14.1版">目录</a>
     <span>|</span>
     <a xmlns:xslthl="http://xslthl.sf.net" href="gradle_daemon.html" title="Gradle 守护进程——Gradle 用户指南 2.14.1版">下一章</a>
    </div>
   </div>
  </div>
 </body>
</html>